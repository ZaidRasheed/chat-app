import{u as A,r as g,a as j,b as s,j as a}from"./index.3e47384e.js";import{H}from"./Header.d37665be.js";import{A as k}from"./Home.c9f168ed.js";function S({chats:t}){const{onlineStatus:l}=A(),[d,C]=g.exports.useState(""),c=g.exports.useMemo(()=>t!=null&&t.data()?Object.entries(t==null?void 0:t.data()):[],[JSON.stringify(t==null?void 0:t.data())]),i=g.exports.useMemo(()=>d.trim()?c.filter(e=>(e[1].userInfo.firstName+" "+e[1].userInfo.lastName).toLowerCase().includes(d.toLowerCase())):c,[d.trim(),JSON.stringify(c)]),L=j();return s("div",{className:"flex-1 bg-gray-100 w-full h-full",children:a("div",{className:"main-body container m-auto w-11/12 h-full flex flex-col pb-7",children:[s(H,{}),a("div",{className:"main flex-1 flex flex-col overflow-auto",children:[s("div",{className:"heading flex-2",children:s("h1",{className:"text-3xl text-gray-700 mb-4",children:"Chat"})}),s("div",{className:"flex-1 flex h-full ",children:a("div",{className:"sidebar w-full lg:flex flex-2 flex-col pr-6",children:[s("div",{className:"search flex-2 pb-6 px-2",children:s("input",{value:d,onChange:e=>C(e.target.value),type:"text",className:"outline-none py-2 block w-full bg-transparent border-b-2 border-gray-200",placeholder:"Search"})}),s("div",{className:"flex-1 h-full px-2",children:i&&(i==null?void 0:i.length)>0?i.sort((e,n)=>n[1].lastMessage.date.seconds-e[1].lastMessage.date.seconds).map(e=>{var p,v,h,b,w,M,y,I,D;const n=new Date(((v=(p=e[1].lastMessage)==null?void 0:p.date)==null?void 0:v.seconds)*1e3),x=new Date,N={year:"numeric",month:"long",day:"numeric"};let f=null;if(n.getDate()===x.getDate()){const r=n.getHours(),o=n.getMinutes()<10?`0${n.getMinutes()}`:n.getMinutes(),u=r>=12;f=(u?r%12:r)+":"+o+(u?" PM":" AM")}else f=n.toLocaleDateString("en",N);let m=null;if(l!=null&&l.get(e[1].userInfo.userId).lastOnline){const r=new Date(l==null?void 0:l.get(e[1].userInfo.userId).lastOnline);if(r.getDate()===x.getDate()){const o=r.getHours(),u=r.getMinutes()<10?`0${r.getMinutes()}`:r.getMinutes(),O=o>=12;m=(O?o%12:o)+":"+u+(O?" PM":" AM")}else m=r.toLocaleDateString("en",N)}if((b=(h=e[1])==null?void 0:h.lastMessage)!=null&&b.message)return a("div",{onClick:()=>L(`/profile/chat/${e[0]}`),className:"entry cursor-pointer transform hover:scale-105 duration-300 transition-transform bg-white mb-4 rounded p-4 flex shadow-md",children:[a("div",{className:"flex-2",children:[a("div",{className:"w-12 h-12 relative",children:[s(k,{name:e[1].userInfo.firstName+" "+e[1].userInfo.lastName,url:e[1].userInfo.profilePictureURL,size:"1"}),(l==null?void 0:l.get(e[1].userInfo.userId).connected)===!0?s("span",{className:"absolute w-4 h-4 bg-green-400 rounded-full right-0 bottom-0 border-2 border-white"}):null]}),l!=null&&l.get(e[1].userInfo.userId).lastOnline?a("p",{className:"text-xs w-16 text-gray-400",children:["Last seen ",m]}):null]}),a("div",{className:"flex-1 px-2",children:[s("div",{className:"truncate w-32",children:s("span",{className:"text-gray-800",children:e[1].userInfo.firstName+" "+e[1].userInfo.lastName})}),s("div",{children:s("small",{className:"text-gray-600",children:(w=e[1])==null?void 0:w.lastMessage.message})})]}),a("div",{className:"flex-2 text-right",children:[s("div",{children:s("small",{className:"text-gray-500",children:f})}),((y=(M=e[1])==null?void 0:M.unOpened)==null?void 0:y.count)>0?s("div",{children:s("small",{className:"text-xs bg-red-500 text-white rounded-full h-6 w-6 leading-6 text-center inline-block",children:(D=(I=e[1])==null?void 0:I.unOpened)==null?void 0:D.count})}):null]})]},e[0])}):null})]})})]})]})})}export{S as default};
